<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Informe SEO Local</title>
  <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/wordcloud2.js/1.1.1/wordcloud2.min.js"></script>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; background: #ffe88d; }
    h1 { color: #333; }
    .kpi-container { display: flex; gap: 20px; margin-bottom: 20px; }
    .kpi { background: white; padding: 20px; border-radius: 10px; box-shadow: 0 2px 6px rgba(0,0,0,0.1); width: 200px; text-align: center; }
    .kpi span { display: block; font-size: 1.4em; margin-top: 10px; color: #222; }
    .section { margin-top: 40px; }
    canvas { width: 100% !important; height: auto !important; }
    table { width: 100%; border-collapse: collapse; background: white; margin-top: 10px; }
    th, td { padding: 8px 12px; border: 1px solid #ddd; }
    th { background-color: #eee; }
  </style>
</head>
<body>
  <h1>Informe de SEO Local: DOBUSS</h1>
  <p>C. Ing. Barbudo, 14013 Córdoba, Spain</p>

  <div class="section">
    <h2>Recomendación de Palabras Clave</h2>
    <table>
      <tr><th>Palabra Clave</th><th>Índice de Competición</th><th>Búsquedas Mensuales</th></tr>
      <tr><td>agencias de seo</td><td>12</td><td>9900</td></tr>
      <tr><td>empresa seo</td><td>7</td><td>1900</td></tr>
      <tr><td>seo agencia</td><td>8</td><td>590</td></tr>
    </table>
  </div>

  <div class="section">
    <h2>Completitud del Perfil</h2>
    <div id="gauge"></div>
  </div>

  <div class="section">
    <h2>Palabras Positivas en Reseñas</h2>
    <canvas id="positiveWords" width="600" height="300"></canvas>
  </div>

  <div class="section">
    <h2>Palabras Negativas en Reseñas</h2>
    <canvas id="negativeWords" width="600" height="300"></canvas>
  </div>

  <div class="section">
    <h2>Datos de Reputación</h2>
    <div class="kpi-container">
      <div class="kpi">Valoraciones<span>525</span></div>
      <div class="kpi">Valoración media<span>4.9</span></div>
      <div class="kpi">Sentimiento medio<span>0.62</span></div>
      <div class="kpi">Magnitud sentimiento<span>1.94</span></div>
    </div>
  </div>
  <script>
    fetch('dashboard_data.json')
      .then(res => res.json())
      .then(data => {
        // Gauge
        Plotly.newPlot('gauge', [{
          type: "indicator",
          mode: "gauge+number",
          value: data.completitud,
          gauge: { axis: { range: [0, 100] } },
          title: { text: "Grado de Completitud del Perfil" }
        }], {width: 400, height: 300});
    
        // KPIs
        document.querySelector(".kpi-container").innerHTML = `
          <div class="kpi">Valoraciones<span>${data.n_valoraciones}</span></div>
          <div class="kpi">Valoración media<span>${data.valoracion_media}</span></div>
          <div class="kpi">Sentimiento medio<span>${data.sentimiento_medio}</span></div>
          <div class="kpi">Magnitud sentimiento<span>${data.magnitud_sentimiento_media}</span></div>
        `;
    
        // Palabras clave
        const tabla = data.palabras_clave.map(p =>
          `<tr><td>${p.keyword}</td><td>${p.indice_competicion}</td><td>${p.busquedas_mensuales}</td></tr>`
        ).join('');
        document.querySelector("table").innerHTML += tabla;
    
        // Nubes
        WordCloud(document.getElementById('positiveWords'), {
          list: data.positivas.map(p => [p, Math.floor(Math.random() * 10 + 5)]),
          gridSize: 10, weightFactor: 10, color: 'green'
        });
        WordCloud(document.getElementById('negativeWords'), {
          list: data.negativas.map(p => [p, Math.floor(Math.random() * 10 + 5)]),
          gridSize: 10, weightFactor: 10, color: 'red'
        });
      });
    </script>
</body>
</html>
